<!DOCTYPE HTML>
<html class="no-js">
    <head>
        <!-- <meta charset="utf-8"> -->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>EVT Viewer</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
        
        <!-- build:css(.) styles/vendor.css -->
        <!-- bower:css -->
        <!-- endbower -->
        <!-- endbuild -->

        <!-- TODO: temp -->
        <!--<link rel="stylesheet" type="text/css" href="css/main.css"></link>-->
        <!-- <link rel="stylesheet" type="text/css" href="css/page_data-include.css"></link> -->
        <!-- <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.9.0.custom.css"></link> -->
        <!-- <link rel="stylesheet" type="text/css" href="css/ImageTextLink.css"></link> -->
        <!-- <link rel="stylesheet" type="text/css" href="css/jquery.jqzoom.css"></link> -->
        <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
        <!-- endbuild -->
        
        <!-- build:css(.tmp) styles/main.css -->
        <link rel="stylesheet" href="styles/main.css">
        <link rel="stylesheet" href="styles/tei.css">
        <link rel="stylesheet" href="config/custom-style.css">
        <!-- endbuild -->

    </head>
    <body ng-app="evtviewer" 
        ng-controller="InterfaceCtrl" 
        ng-keydown="handleKeydownEvent($event)"
        ng-click="handleGenericClick($event)">
    <!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <!-- Add your site or application content here -->
    

    <header>
        {{ getProperty('indexTitle') }}
        <div class="globalMenu">
            <button-switch 
                    title="{{mode.label}}"
                    class="mode-view"
                    data-label=""
                    data-icon="{{mode.icon}}"
                    data-value="{{mode.viewMode}}"
                    data-type="changeViewMode"
                    ng-repeat="mode in getAvailableViewModes()"
                    ng-if="mode.visible">
            </button-switch>
            <!-- <button-switch 
                    title="Witnesses"
                    data-icon="witnesses"
                    data-type="openGlobalDialogWitnesses">
            </button-switch> -->
            <button-switch 
                    class="smaller"
                    title="Info"
                    data-icon="info"
                    data-type="openGlobalDialogInfo">
            </button-switch>
            <button-switch 
                    title="Bookmark"
                    data-icon="bookmark"                    
                    data-type="bookmark">
            </button-switch>
            <button-switch 
                    title="Search"
                    data-icon="search"                    
                    data-type="searchTools"
                    ng-show="getSearchBoxPosition()=='external'">
            </button-switch>
            <!-- <button-switch 
                    class="noPadding"
                    title="Menu"
                    data-icon="menu-vert"                    
                    data-type="openMenu">
            </button-switch> -->
        </div>
    </header>
    <section 
        class="secondary-container" 
        ng-show="getSecondaryContentOpened() !== ''"  
        ng-if="!isLoading()">
        <evt-dialog data-type="globalInfo" data-title="Project Info">
            <evt-tabs-container 
                data-type="projectInfo" 
                data-orientation="vertical">
            </evt-tabs-container>
        </evt-dialog>
        <evt-dialog data-type="witnessesList" data-title="Witnesses">
            <div compile="getWitnessesListFormatted()"></div>
        </evt-dialog>
        <evt-dialog data-type="bookmark" data-title="Bookmark">
            <div compile="getBookmark()"></div>
        </evt-dialog>
    </section>
    
    <section id="global-container" ng-switch="getCurrentViewMode()" ng-if="!isLoading()">
        <!-- <div id="left-nav"><span><i class="fa fa-chevron-circle-left"></i></span></div> -->
        
        <!-- READING TEXT -->
        <section id="main-container" class="viewMode" ng-switch-when="readingTxt">
            <evt-search-box 
                ng-controller="SearchBoxCtrl as searchBox"
                ng-show="searchBox.getPosition()=='external'"> 
            </evt-search-box>
            <box data-type="text"
                 data-edition="{{getCurrentEdition()}}"
                 id="mainText"
                 ng-class="{'centered': !isPinnedAppBoardOpened(),
                            'half-centered': isPinnedAppBoardOpened()}"></box>
            <button-switch 
                    title="Show pinned apparatus entries"
                    data-label=""
                    data-icon="pin"
                    data-type="togglePinned"
                    ng-if="isToolAvailable('toolPinAppEntries') && getPinnedEntries().length > 0 && entry !== ''"
                    class="togglePinned_btn"
                    ng-class="{'centered': !isPinnedAppBoardOpened(),
                               'half-centered': isPinnedAppBoardOpened()}">
            </button-switch>

            <box data-type="pinnedBoard" 
                ng-show="!isLoading() && isPinnedAppBoardOpened()">
                 <span ng-if="!isLoading() && getPinnedEntries().length <= 0">
                    <!--No apparatus entries pinned.--></span>
                 <evt-critical-apparatus-entry 
                    class="in_critical_apparatus" 
                    ng-class="{'active': getCurrentAppEntry() === entry}"
                    ng-if="getPinnedEntries().length > 0 && entry !== ''"
                    ng-click="updateCurrentAppEntry(entry);"
                    ng-repeat="entry in getPinnedEntries()"
                    data-type="pinned"
                    data-app-id="{{entry}}"></evt-critical-apparatus-entry>
            </box>
        </section> 

        <!-- COLLAZIONE -->
        <section id="main-container" class="viewMode" ng-switch-when="collation">
            <box data-type="text"
                 data-edition="{{getCurrentEdition()}}"
                 id="mainText"
                 ng-show="existCriticalText()"></box>
            <!-- <div 
                compile="printCriticalApparatus()"
                style="position: absolute; background: rgb(255, 255, 255) none repeat scroll 0% 0%;"> -->

            <div class="compareWits_box" id="compareWits_box"
                 ng-class="{'span9of18': (existCriticalText() && getCurrentWitnesses().length <= 1),
                            'span18of18': !existCriticalText()}">
                <box data-type="witness"
                     data-witness="{{witness}}"
                     data-witpage="{{getCurrentWitnessPage(witness)}}"
                     ng-repeat="witness in getCurrentWitnesses()" ></box>
            </div>
            <button-switch 
                    title="Add Witness"
                    data-label="Add Witness"
                    data-icon="add"
                    data-type="addWit"
                    class="compareWits_box--buttonAddWit inverted-color witnessSelector"
                    ng-class="{'left75': (!existCriticalText() && getCurrentWitnesses().length == 1) || (existCriticalText() && getCurrentWitnesses().length == 0),
                                'floatRight': (!existCriticalText() && getCurrentWitnesses().length > 1) || (existCriticalText() && getCurrentWitnesses().length > 0)}">
            </button-switch>

            <div 
                ng-if="isWitnessSelectorActive()"
                class="availableWitnesses-selector witnessSelector"
                ng-class="{'left75': (!existCriticalText() && getCurrentWitnesses().length == 1) || (existCriticalText() && getCurrentWitnesses().length == 0)}">
                <span 
                    ng-click="addWitness(witness)" 
                    ng-repeat="witness in getAvailableWitnesses()">{{getWitness(witness)}}</span>
            </div>

        </section>       

        <!-- TXT TXT -->
        <section id="main-container" class="viewMode" ng-switch-when="txtTxt">
            <box data-type="text"
                 data-edition="{{getCurrentEdition()}}"
                 id="mainText1"></box>
            <box data-type="text"
                 data-edition="{{getCurrentEdition()}}"
                 id="mainText2"></box>
        </section>

        <!-- IMG TXT -->
        <section id="main-container" class="viewMode" ng-switch-when="imgTxt">
            <box data-type="image"
                 id="mainImage"></box>
            <box data-type="text"
                 data-edition="{{getCurrentEdition()}}"
                 id="mainText"></box>
        </section>

        <!-- LOADING... -->
        <section id="main-container" class="viewMode" ng-switch-default>
            <div class="loading"><i class="fa fa-spinner fa-pulse loader"></i></div>
        </section>
        <!-- <div id="right-nav"><span><i class="fa fa-chevron-circle-right"></i></span></div> -->
    </section>

    <section class="global-msg-container" 
            ng-if="!isLoading() && getErrorMsg() !== undefined && getErrorMsg().title !== ''">
        <div class="global-msg"> 
            <h1>EVT Viewer</h1>
            <h2>{{getErrorMsg().title}}</h2>
            <p>{{ getErrorMsg().msg }}</p>
        </div>
    </section>

    <section class="global-loading-container" 
            ng-hide="!isLoading()">
        <!-- LOADING... -->
        <div class="loading"><i class="fa fa-spinner fa-pulse loader"></i></div>
    </section>
    
    <evt-dialog 
        data-id="errorMsg"
        data-type="error" 
        data-title="ERROR" ></evt-dialog>
    <footer>Footer</footer>


    <!-- TODO: change route system -->
    <!-- <div ng-view=""></div> -->
    
    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID -->
    <!--
    <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

       ga('create', 'UA-XXXXX-X');
       ga('send', 'pageview');
    </script>
    -->

    <!-- build:js(.) scripts/oldieshim.js -->
    <!--[if lt IE 9]>
    <script src="bower_components/es5-shim/es5-shim.js"></script>
    <script src="bower_components/json3/lib/json3.js"></script>
    <![endif]-->
    <!-- endbuild -->

    <!-- build:js(.) scripts/lib.js -->
    <!-- bower:js -->
    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/angular-animate/angular-animate.js"></script>
    <script src="bower_components/angular-cookies/angular-cookies.js"></script>
    <script src="bower_components/angular-messages/angular-messages.js"></script>
    <script src="bower_components/angular-resource/angular-resource.js"></script>
    <script src="bower_components/angular-route/angular-route.js"></script>
    <script src="bower_components/angular-sanitize/angular-sanitize.js"></script>
    <script src="bower_components/angular-xml/angular-xml.js"></script>
    <script src="bower_components/angular-touch/angular-touch.js"></script>
    <script src="bower_components/angular-pretty-xml/src/angular-pretty-xml.js"></script>
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js({.tmp,app}) scripts/evtviewer.js -->
    <script src="tmpl/templates.js"></script>
    <script src="/src/evtviewer.js"></script>

    <!-- injector:js -->
    <script src="/src/core/core.js"></script>
    <script src="/src/core/GLOBALDEFAULTCONF.constant.js"></script>
    <script src="/src/core/utils.provider.js"></script>
    <script src="/src/core/config.provider.js"></script>
    <script src="/src/core/log.enhance.js"></script>
    <script src="/src/core/eventDispatcher.service.js"></script>
    <script src="/src/core/compile.directive.js"></script>

    <script src="/src/dataHandler/dataHandler.js"></script>
    <script src="/src/dataHandler/baseData.service.js"></script>
    <script src="/src/dataHandler/parsedData.service.js"></script>
    <script src="/src/dataHandler/parser.service.js"></script>
    <script src="/src/dataHandler/criticalParser.service.js"></script>
    <script src="/src/dataHandler/criticalApparatus.service.js"></script>
    <script src="/src/dataHandler/primarySourcesParser.service.js"></script>
    <script src="/src/dataHandler/projectInfoParser.service.js"></script>

    <script src="/src/interface/interface.js"></script>
    <script src="/src/interface/interface.configuration.js"></script>
    <script src="/src/interface/interface.controller.js"></script>
    <script src="/src/interface/interface.service.js"></script>

    <script src="/src/communication/communication.js"></script>
    <script src="/src/communication/communication.service.js"></script>

    <script src="/src/UItools/UItools.service.js"></script>
    <script src="/src/UItools/imageTextLinking.service.js"></script>

    <script src="/src/box/box.js"></script>
    <script src="/src/box/box.configuration.js"></script>
    <script src="/src/box/box.provider.js"></script>
    <script src="/src/box/box.directive.js"></script>

    <script src="/src/select/select.js"></script>
    <script src="/src/select/select.configuration.js"></script>
    <script src="/src/select/select.provider.js"></script>
    <script src="/src/select/select.controller.js"></script>
    <script src="/src/select/select.directive.js"></script>

    <script src="/src/buttonSwitch/buttonSwitch.js"></script>
    <script src="/src/buttonSwitch/buttonSwitch.provider.js"></script>
    <script src="/src/buttonSwitch/buttonSwitch.directive.js"></script>

    <script src="/src/popover/popover.js"></script>
    <script src="/src/popover/popover.configuration.js"></script>
    <script src="/src/popover/popover.provider.js"></script>
    <script src="/src/popover/popover.controller.js"></script>
    <script src="/src/popover/popover.directive.js"></script>

    <script src="/src/mobile/mobile.js"></script>
    <script src="/src/mobile/mobile.dir.js"></script>
    <script src="/src/mobile/mobile.provider.js"></script>
    <script src="/src/mobile/mobileMenu.ctrl.js"></script>
    <script src="/src/mobile/mobileMenu.dir.js"></script>
    <script src="/src/mobile/mobileInfo.ctrl.js"></script>
    <script src="/src/mobile/mobileInfo.dir.js"></script>
    <script src="/src/mobile/mobileSearch.ctrl.js"></script>
    <script src="/src/mobile/mobileSearch.dir.js"></script>
    <script src="/src/mobile/mobileView.ctrl.js"></script>
    <script src="/src/mobile/mobileView.dir.js"></script>

    <script src="/src/criticalApparatusEntry/criticalApparatusEntry.js"></script>
    <script src="/src/criticalApparatusEntry/criticalApparatusEntry.configuration.js"></script>
    <script src="/src/criticalApparatusEntry/criticalApparatusEntry.provider.js"></script>
    <script src="/src/criticalApparatusEntry/criticalApparatusEntry.controller.js"></script>
    <script src="/src/criticalApparatusEntry/criticalApparatusEntry.directive.js"></script>
    <script src="/src/criticalApparatusEntry/criticalApparatusEntry.witnessRef.directive.js"></script>

    <script src="/src/reading/reading.js"></script>
    <script src="/src/reading/reading.configuration.js"></script>
    <script src="/src/reading/reading.provider.js"></script>
    <script src="/src/reading/reading.controller.js"></script>
    <script src="/src/reading/reading.directive.js"></script>

    <script src="/src/dialog/dialog.js"></script>
    <script src="/src/dialog/dialog.configuration.js"></script>
    <script src="/src/dialog/dialog.provider.js"></script>
    <script src="/src/dialog/dialog.directive.js"></script>

    <script src="/src/tabsContainer/tabsContainer.js"></script>
    <script src="/src/tabsContainer/tabsContainer.controller.js"></script>
    <script src="/src/tabsContainer/tabsContainer.directive.js"></script>
        
    <script src="/src/search/search.js"></script>
    <script src="/src/search/search.configuration.js"></script>
    <script src="/src/search/searchBox.directive.js"></script>
    <script src="/src/search/searchBox.controller.js"></script>
    <script src="/src/search/searchBox.provider.js"></script>
    <!-- endinjector -->
    <!-- endbuild -->

</body>
</html>
